<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeedType - Typing Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .cursor {
            background-color: rgb(227, 227, 227);
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        .correct {
            color: #10b981;
        }
        .incorrect {
            color: #ef4444;
            text-decoration: underline;
        }
        .active {
            background-color: #dbeafe;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen flex flex-col">
    <header class="py-6">
        <div class="container mx-auto px-4 text-center">
            <h1 class="text-4xl font-bold mb-2">Speed<span class="text-blue-400">Type</span></h1>
            <p class="text-gray-400">Test your typing speed and accuracy</p>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 flex flex-col">
        <!-- Stats Bar -->
        <div class="flex justify-between mb-8 bg-gray-800 p-4 rounded-lg">
            <div class="text-center">
                <div class="text-sm text-gray-400">Time</div>
                <div id="time" class="text-2xl font-mono">60</div>
            </div>
            <div class="text-center">
                <div class="text-sm text-gray-400">WPM</div>
                <div id="wpm" class="text-2xl font-mono">0</div>
            </div>
            <div class="text-center">
                <div class="text-sm text-gray-400">Accuracy</div>
                <div id="accuracy" class="text-2xl font-mono">0%</div>
            </div>
            <div class="text-center">
                <div class="text-sm text-gray-400">Correct</div>
                <div id="correct" class="text-2xl font-mono">0</div>
            </div>
            <div class="text-center">
                <div class="text-sm text-gray-400">Incorrect</div>
                <div id="incorrect" class="text-2xl font-mono">0</div>
            </div>
        </div>

        <!-- Mode Selector -->
        <div class="flex justify-center mb-8">
            <div class="inline-flex rounded-md shadow-sm" role="group">
                <button onclick="changeMode(0)" id="time-btn" class="px-4 py-2 text-sm font-medium rounded-l-lg bg-blue-600 text-white">
                    30s
                </button>
                <button onclick="changeMode(1)" class="px-4 py-2 text-sm font-medium bg-gray-700 text-gray-300 hover:bg-gray-600">
                    60s
                </button>
                <button onclick="changeMode(2)" class="px-4 py-2 text-sm font-medium rounded-r-lg bg-gray-700 text-gray-300 hover:bg-gray-600">
                    120s
                </button>
            </div>
        </div>

        <!-- Typing Area -->
        <div id="text-display" class="bg-gray-800 p-6 rounded-lg mb-6 text-2xl leading-relaxed tracking-wider font-mono h-40 overflow-auto">
            Loading text...
        </div>

        <div class="relative mb-8">
            <textarea 
                id="input-field" 
                class="w-full bg-gray-800 rounded-lg p-4 text-xl font-mono h-32 focus:outline-none focus:ring-2 focus:ring-blue-500" 
                placeholder="Start typing here..."
                autofocus
                spellcheck="false"
                disabled
            ></textarea>
            <div id="restart-btn" class="absolute right-3 bottom-4 text-gray-400 hover:text-white cursor-pointer hidden">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                </svg>
            </div>
        </div>

        <!-- Result Modal -->
        <div id="result-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-gray-800 rounded-lg p-8 max-w-md w-full">
                <h2 class="text-2xl font-bold mb-4">Test Completed!</h2>
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div>
                        <div class="text-sm text-gray-400">Words per minute</div>
                        <div id="result-wpm" class="text-3xl font-bold">0</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-400">Accuracy</div>
                        <div id="result-accuracy" class="text-3xl font-bold">0%</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-400">Correct chars</div>
                        <div id="result-correct" class="text-3xl font-bold">0</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-400">Incorrect chars</div>
                        <div id="result-incorrect" class="text-3xl font-bold">0</div>
                    </div>
                </div>
                
                <button onclick="resetTest()" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors">
                    Try Again
                </button>
            </div>
        </div>
    </main>

    <footer class="py-4 text-center text-gray-500 text-sm">
        <p>Created with ❤️ for typing enthusiasts</p>
    </footer>

    <script>
        // Variables
        let timer;
        let timeLeft = 60;
        let isTestActive = false;
        let currentMode = 1; // 0=30s, 1=60s, 2=120s
        let currentText = "";
        let typedChars = [];
        let startTime = 0;
        
        // DOM Elements
        const textDisplay = document.getElementById('text-display');
        const inputField = document.getElementById('input-field');
        const timeDisplay = document.getElementById('time');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const correctDisplay = document.getElementById('correct');
        const incorrectDisplay = document.getElementById('incorrect');
        const restartBtn = document.getElementById('restart-btn');
        const resultModal = document.getElementById('result-modal');
        
        // Sample texts (can be expanded)
        const sampleTexts = [
            "The quick brown fox jumps over the lazy dog while counting from one to ten and back again in a rapid motion that surprises everyone watching this peculiar behavior.",
            "Programming is the process of creating a set of instructions that tell a computer how to perform a task. Programming can be done using a variety of computer programming languages.",
            "To be or not to be, that is the question: whether 'tis nobler in the mind to suffer the slings and arrows of outrageous fortune or to take arms against a sea of troubles and by opposing end them.",
            "The greatest glory in living lies not in never falling, but in rising every time we fall. Life is really simple, but we insist on making it complicated.",
            "In the middle of difficulty lies opportunity. You cannot shake hands with a clenched fist. The weak can never forgive. Forgiveness is the attribute of the strong."
        ];
        
        // Initialize
        window.onload = function() {
            loadNewText();
            setupEventListeners();
        };
        
        function setupEventListeners() {
            inputField.addEventListener('input', handleTyping);
            inputField.addEventListener('focus', startTestOnFirstTyping);
            restartBtn.addEventListener('click', resetTest);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    resetTest();
                }
            });
        }
        
        function loadNewText() {
            currentText = sampleTexts[Math.floor(Math.random() * sampleTexts.length)];
            renderText();
        }
        
        function renderText() {
            let html = '';
            for (let i = 0; i < currentText.length; i++) {
                let charClass = '';
                
                if (i < typedChars.length) {
                    charClass = typedChars[i].correct ? 'correct' : 'incorrect';
                }
                
                if (i === typedChars.length) {
                    charClass += ' cursor';
                }
                
                html += `<span class="${charClass}">${currentText[i]}</span>`;
            }
            
            // Add remaining text if any
            if (typedChars.length < currentText.length) {
                html += currentText.substring(typedChars.length);
            }
            
            textDisplay.innerHTML = html;
            
            // Scroll to active character
            const activeSpan = textDisplay.querySelector('.cursor');
            if (activeSpan) {
                activeSpan.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }
        
        function startTestOnFirstTyping() {
            if (!isTestActive && typedChars.length === 0) {
                startTest();
            }
        }
        
        function startTest() {
            isTestActive = true;
            inputField.disabled = false;
            inputField.focus();
            startTime = Date.now();
            startTimer();
            restartBtn.classList.remove('hidden');
        }
        
        function startTimer() {
            updateTimerDisplay();
            
            timer = setInterval(function() {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    endTest();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            timeDisplay.textContent = timeLeft;
        }
        
        function handleTyping(e) {
            if (!isTestActive) return;
            
            const inputText = e.target.value;
            const inputLength = inputText.length;
            
            // Reset typedChars if user deletes everything
            if (inputLength === 0) {
                typedChars = [];
                renderText();
                updateStats();
                return;
            }
            
            const currentChar = inputText[inputLength - 1];
            const expectedChar = currentText[inputLength - 1];
            
            // Check if character is correct
            const isCorrect = currentChar === expectedChar;
            
            // Add to typedChars
            if (inputLength > typedChars.length) {
                typedChars.push({
                    char: currentChar,
                    correct: isCorrect,
                    timestamp: Date.now()
                });
            } else {
                // Update last character if user modified it
                typedChars[inputLength - 1] = {
                    char: currentChar,
                    correct: isCorrect,
                    timestamp: Date.now()
                };
            }
            
            // Render updated text
            renderText();
            
            // Update stats
            updateStats();
            
            // Check if we've reached the end of the text
            if (inputLength === currentText.length) {
                // End of text - load new one
                loadNewText();
                e.target.value = '';
                typedChars = [];
            }
        }
        
        function updateStats() {
            // Calculate correct and incorrect characters
            const correct = typedChars.filter(c => c.correct).length;
            const incorrect = typedChars.filter(c => !c.correct).length;
            
            // Calculate accuracy
            const totalTyped = correct + incorrect;
            const accuracy = totalTyped > 0 ? Math.round((correct / totalTyped) * 100) : 0;
            
            // Calculate WPM (5 characters = 1 word)
            const elapsedMinutes = (Date.now() - startTime) / 60000;
            const wordsTyped = correct / 5;
            const wpm = elapsedMinutes > 0 ? Math.round(wordsTyped / elapsedMinutes) : 0;
            
            // Update displays
            correctDisplay.textContent = correct;
            incorrectDisplay.textContent = incorrect;
            accuracyDisplay.textContent = accuracy + '%';
            wpmDisplay.textContent = wpm;
        }
        
        function endTest() {
            clearInterval(timer);
            isTestActive = false;
            inputField.disabled = true;
            
            // Show results
            showResults();
        }
        
        function showResults() {
            document.getElementById('result-wpm').textContent = wpmDisplay.textContent;
            document.getElementById('result-accuracy').textContent = accuracyDisplay.textContent;
            document.getElementById('result-correct').textContent = correctDisplay.textContent;
            document.getElementById('result-incorrect').textContent = incorrectDisplay.textContent;
            
            resultModal.classList.remove('hidden');
        }
        
        function resetTest() {
            clearInterval(timer);
            
            // Reset variables
            timeLeft = currentMode === 0 ? 30 : currentMode === 1 ? 60 : 120;
            isTestActive = false;
            typedChars = [];
            inputField.value = '';
            
            // Reset displays
            timeDisplay.textContent = timeLeft;
            wpmDisplay.textContent = '0';
            accuracyDisplay.textContent = '0%';
            correctDisplay.textContent = '0';
            incorrectDisplay.textContent = '0';
            
            // Load new text
            loadNewText();
            
            // Reset UI
            inputField.disabled = false;
            inputField.focus();
            restartBtn.classList.add('hidden');
            resultModal.classList.add('hidden');
        }
        
        function changeMode(mode) {
            currentMode = mode;
            
            // Update button styles
            document.querySelectorAll('button[onclick^="changeMode"]').forEach(btn => {
                btn.className = btn.className.replace('bg-blue-600 text-white', 'bg-gray-700 text-gray-300 hover:bg-gray-600');
            });
            
            let activeBtn;
            switch(mode) {
                case 0:
                    activeBtn = document.getElementById('time-btn');
                    timeLeft = 30;
                    break;
                case 1:
                    timeLeft = 60;
                    break;
                case 2:
                    timeLeft = 120;
                    break;
            }
            
            document.querySelector(`button[onclick="changeMode(${mode})"]`).className += ' bg-blue-600 text-white';
            timeDisplay.textContent = timeLeft;
            
            if (!isTestActive) {
                resetTest();
            }
        }
    </script>
</body>
</html>
